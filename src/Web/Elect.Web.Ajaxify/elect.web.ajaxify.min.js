var elect=elect||{};elect.ajaxify={isEnable:true,preventAjaxifySelector:".no-ajaxify",bodySelector:".document-body",scriptSelector:".document-script",contentSelector:"#document-content,article:first,.article:first,.post:first",menuSelector:"#menu,#nav,nav:first,.nav:first",activeClass:"active selected current",activeSelector:".active,.selected,.current",menuChildrenSelector:"> li,> ul > li",fnBeforeRedirect:undefined,fnAfterRedirect:undefined};(function(c,e){var b=c.History;var d=c.jQuery;var a=c.document;if(!b.enabled){return false}d(function(){var h=d(elect.ajaxify.contentSelector).filter(":first");var f=h.get(0);var i=d(elect.ajaxify.menuSelector).filter(":first");var l=d(c);var k=d(a.body);var g=b.getRootUrl();if(h.length===0){h=k}d.expr[":"].internal=function(p,r,u,t){var s=d(p),n=s.attr("href")||"",q;var o=n.substring(0,g.length)===g;var w=n.indexOf(":")===-1;q=o||w;if(w===true){if(n.startsWith("#")){return false}}if(o===true){var v=n.replace(c.location.href,"");if(v.startsWith("#")||v.startsWith("/#")){return false}}return q};var m=function(o){var n=String(o).replace(/<\!DOCTYPE[^>]*>/i,"").replace(/<(html|head|body|title|meta|script)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(html|head|body|title|meta|script)\>/gi,"</div>");return d.trim(n)};var j=function(o){var n=a.createElement("textarea");n.innerHTML=o;return n.value};d.fn.ajaxify=function(){var n=d(this);n.find("a:internal:not("+elect.ajaxify.preventAjaxifySelector+")").click(function(r){var s=d(this),p=s.attr("href"),t=s.attr("title")||null;if(elect.ajaxify.isEnable!==true){return true}var q=elect.ajaxify.fnBeforeRedirect;if(q&&typeof q==="function"){var o=q(s,p);if(o===false){r.preventDefault();return}}if(r.which==2||r.metaKey){return true}b.pushState(null,t,p);r.preventDefault();return false});return n};k.ajaxify();l.bind("statechange",function(){var o=b.getState(),p=o.url,n=p.replace(g,"");k.addClass("loading");h.animate({opacity:0},800);d.ajax({url:p,method:"GET",beforeSend:function(q){q.setRequestHeader("X-Requested-With","Elect.Web.Ajaxify")},success:function(L,w,G){var M=m(L),x=d(M),B=x.find(elect.ajaxify.bodySelector+":first"),q=B.find(elect.ajaxify.contentSelector).filter(":first"),r,u,v;var z=M.indexOf('<div class="document-main-script-start"></div>')+'<div class="document-main-script-start"></div>'.length+1;var I=M.lastIndexOf('<div class="document-main-script-end"></div>');var F=M.substr(z,I-z).trim();var y=F.split('<div class="document-script"');for(var H=0;H<y.length;H++){var J=y[H];var N=J.indexOf(">")+1;var A=J.substr(0,N);if(A.includes("src")){y[H]=J='<div class="document-script"'+J;continue}var K=J.lastIndexOf("</div>");y[H]=J=J.substr(N,K-N).trim()}c.mainScripts=y;v=q.find(elect.ajaxify.scriptSelector);if(v.length){v.detach()}u=q.html()||x.html();if(!u){a.location.href=p;return false}r=i.find(elect.ajaxify.menuChildrenSelector);r.filter(elect.ajaxify.activeSelector).removeClass(elect.ajaxify.activeClass);r=r.has('a[href^="'+n+'"],a[href^="/'+n+'"],a[href^="'+p+'"]');if(r.length===1){r.addClass(elect.ajaxify.activeClass)}h.stop(true,true);h.html(u).ajaxify().css("opacity",100).show();a.title=x.find(".document-title:first").text();try{a.getElementsByTagName("title")[0].innerHTML=a.title.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(D){}c.onerror=function(){location.reload()};for(var H=0;H<v.length;H++){var t=d(v[H]);var C=j(t.html());var E=a.createElement("script");if(t.attr("src")){if(!t[0].async){E.async=false}E.src=t.attr("src")}else{C=y[H]}E.appendChild(a.createTextNode(C));f.appendChild(E)}c.scrollTo(0,0);k.removeClass("loading");var s=elect.ajaxify.fnAfterRedirect;if(s&&typeof s==="function"){s(p)}if(typeof c._gaq!=="undefined"){c._gaq.push(["_trackPageview",n])}if(typeof c.reinvigorate!=="undefined"&&typeof c.reinvigorate.ajax_track!=="undefined"){reinvigorate.ajax_track(p)}c.onerror=function(){}},error:function(q,s,r){a.location.href=p;return false}})})})})(window);