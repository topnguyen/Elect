(function(n){function i(n){return n?"addClass":"removeClass"}n(document).on("input change","table.dataTable thead input[type=text]",function(){n(this)[i(this.value&&!n(this).hasClass("search_init"))]("x")}).on("mousemove",".x",function(t){n(this)[i(this.offsetWidth-18<t.clientX-this.getBoundingClientRect().left)]("onX")}).on("click",".onX",function(){n(this).removeClass("x onX").val("").trigger("input").trigger("change")});var t=function(){var n=0;return function(t,i){clearTimeout(n);n=setTimeout(t,i)}};n.fn.columnFilter=function(i){function w(n,t,i,r,f){var s,e,o,c;if(typeof t=="undefined")return[];for(typeof i=="undefined"&&(i=!0),typeof r=="undefined"&&(r=!0),typeof f=="undefined"&&(f=!0),s=r==!0?n.aiDisplay:n.aiDisplayMaster,e=[],o=0,c=s.length;o<c;o++){var l=s[o],a=u.fnGetData(l),h=a[t];if(f==!0&&h.length==0)continue;else if(i==!0&&jQuery.inArray(h,e)>-1)continue;else e.push(h)}return e.sort()}function l(n){return e.bUseColVis?n:u.fnSettings().oApi._fnVisibleToColumnIndex(u.fnSettings(),n)}function b(i,u,o,h,a,y){var d="text_filter form-control",p,b,k;h&&(d="number_filter form-control");s=s.replace(/(^\s*)|(\s*$)/g,"");var w=i.fnSettings().aoPreSearchCols[r].sSearch,g="search_init ",nt="";if(w!=""&&w!="^"&&(nt=h&&w.charAt(0)=="^"?w.substr(1):w,g=""),p=n('<input type="text" class="'+g+d+'" rel="'+r+'"/>').val(nt).attr("placeholder",s),y!=undefined&&y!=-1&&p.attr("maxlength",y),f.html(p),h?f.wrapInner('<span class="filter_column filter_number" />'):f.wrapInner('<span class="filter_column filter_text" />'),v[r]=s,b=r,h&&!i.fnSettings().oFeatures.bServerSide){k=new t;p.on("input",function(){var n=this;k.delay(function(){i.fnFilter("^"+n.value,l(b),!0,!1);c()},e.iFilteringDelay)})}else{k=new t;p.on("input",function(){var t=this;k(function(){var e,r,f;if(i.fnSettings().oFeatures.bServerSide&&a!=0){if(e=i.fnSettings().aoPreSearchCols[b].sSearch,r=n(t).data("dt-iLastFilterLength"),typeof r=="undefined"&&(r=0),f=t.value.length,Math.abs(f-r)<a)return;n(t).data("dt-iLastFilterLength",f)}i.fnFilter(t.value,l(b),u,o);c()},e.iFilteringDelay)})}p.focus(function(){n(this).hasClass("search_init")&&(n(this).removeClass("search_init"),this.value="")});p.blur(function(){this.value==""&&(n(this).addClass("search_init"),this.value=v[b])})}function tt(i){var s=i.fnSettings().aoPreSearchCols[r].sSearch,p="",w="",h,u,b,o,k,v,d;s!=""&&s!="undefined"&&(h=s.split("~"),p=h[0],w=h[1]);f.html(y(0));u=i.attr("id")+"_range_from_"+r;b=n('<input type="text" class="number_range_filter form-control" id="'+u+'"  value = "'+p+'" rel="'+r+'"/>');f.append(b);f.append(y(1));o=i.attr("id")+"_range_to_"+r;k=n('<input type="text" class="number_range_filter form-control" id="'+o+'" value="'+w+'" rel="'+r+'"/>');f.append(k);f.append(y(2));f.wrapInner('<span class="filter_column filter_number_range" />');v=r;a.push(r);i.dataTableExt.afnFiltering.push(function(n,t){if(i.attr("id")!=n.sTableId||document.getElementById(u)==null)return!0;var r=document.getElementById(u).value*1,f=document.getElementById(o).value*1,e=t[l(v)]=="-"?0:t[l(v)]*1;return r==""&&f==""?!0:r==""&&e<=f||r<=e&&""==f||r<=e&&e<=f?!0:!1});d=new t;n("#"+u+",#"+o,f).on("input",function(){d(function(){var n=document.getElementById(u).value*1,t=document.getElementById(o).value*1;n!=0&&t!=0&&n>t||(i.fnDraw(),c())},e.iFilteringDelay)})}function d(i,u){var p=i.fnSettings().aoPreSearchCols[r].sSearch,d="",g="",w,v,b,o,k,s,y,nt;for(p!=""&&p!="undefined"&&(w=p.split("~"),d=w[0],g=w[1]),v=h.split(/[}{]/),f.html(""),b=i.attr("id")+"_range_from_"+r,o=n('<input type="text" class="date_range_filter form-control" id="'+b+'" value="'+d+'" rel="'+r+'"/>'),o[u].apply(o),k=i.attr("id")+"_range_to_"+r,s=n('<input type="text" class="date_range_filter form-control" id="'+k+'" value="'+g+'" rel="'+r+'"/>'),ti=0;ti<v.length;ti++)v[ti]==e.sDateFromToken?f.append(o):v[ti]==e.sDateToToken?f.append(s):f.append(v[ti]);f.wrapInner('<span class="filter_column filter_date_range" />');s[u].apply(s);y=r;a.push(r);i.dataTableExt.afnFiltering.push(function(t,r){var f,e,u;if(i.attr("id")!=t.sTableId||(f=o[datepickerFunctionName].call(o,"getDate"),e=s[datepickerFunctionName].call(s,"getDate"),f==null&&e==null))return!0;u=null;try{if(r[l(y)]==null||r[l(y)]=="")return!1;u=n.datepicker.parseDate(n.datepicker.regional[""].dateFormat,r[l(y)])}catch(h){return!1}return u==null?!1:f==null&&u<=e?!0:f<=u&&e==null||f<=u&&u<=e?!0:!1});nt=new t;n("#"+b+",#"+k,f).change(function(){nt(function(){i.fnDraw();c()},e.iFilteringDelay)})}function g(t,i,u,f,e,o,s,h){var b,a,y,l,k,v,p;for(i==null&&(i=w(t.fnSettings(),u,!0,!1,!0)),b=u,a=t.fnSettings().aoPreSearchCols[r].sSearch,(a==null||a=="")&&(a=s),y='<select class="search_init select_filter form-control" rel="'+r+'"><option value="" class="search_init">'+e+"<\/option>",h&&(y='<select class="search_init select_filter form-control" rel="'+r+'" multiple>'),l=0,k=i.length,l=0;l<k;l++)typeof i[l]!="object"?(v="",(escape(i[l])==a||escape(i[l])==escape(a))&&(v="selected "),y+="<option "+v+' value="'+escape(i[l])+'">'+i[l]+"<\/option>"):(v="",o?(i[l].value==a&&(v="selected "),y+="<option "+v+'value="'+i[l].value+'">'+i[l].label+"<\/option>"):(escape(i[l].value)==a&&(v="selected "),y+="<option "+v+'value="'+escape(i[l].value)+'">'+i[l].label+"<\/option>"));p=n(y+"<\/select>");f.html(p);f.wrapInner('<span class="filter_column filter_select" />');h?p.change(function(){var i,r,u;n(this).val()!=""?n(this).removeClass("search_init"):n(this).addClass("search_init");i=n(this).val();r=[];i==null||i==[]?u="^(.*)$":(n.each(i,function(n,t){r.push(rt(t))}),u="^("+r.join("|")+")$");t.fnFilter(u,b,!0,!1)}):p.change(function(){n(this).val()!=""?n(this).removeClass("search_init"):n(this).addClass("search_init");o?t.fnFilter(n(this).val(),u,o):t.fnFilter(unescape(n(this).val()),u);c()})}function it(n,t,i,u,e){var o=n.fnSettings();t!=null&&typeof t!="function"||o.sAjaxSource==""||o.oFeatures.bServerSide||o.aoDrawCallback.push({fn:function(r,f,o){return function(s){if(s.iDraw==2&&s.sAjaxSource!=null&&s.sAjaxSource!=""&&!s.oFeatures.bServerSide)return g(n,t&&t(s.aoData,s),l(r),f,o,i,u,e)}}(r,f,s),sName:"column_filter_"+r});g(n,typeof t=="function"?null:t,l(r),f,s,i,u,e)}function rt(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function nt(t){for(var h=r,o='<div class="dropdown select_filter form-control"><a class="dropdown-toggle" data-toggle="dropdown" href="#">'+s+'<b class="caret"><\/b><\/a><ul class="dropdown-menu" role="menu"><li data-value=""><a>Show All<\/a><\/li>',c=t.length,e,i=0;i<c;i++)o+='<li data-value="'+t[i]+'"><a>'+t[i]+"<\/a><\/li>";e=n(o+"<\/ul><\/div>");f.html(e);f.wrapInner('<span class="filterColumn filter_select" />');e.find("li").click(function(){u.fnFilter(n(this).data("value"),h)})}function ut(t,i){var p,k,rt,g,ft,tt,ot;i==null&&(i=w(t.fnSettings(),r,!0,!0,!0));var it=r,h="",u,y=i.length,o=s.replace("%","Perc").replace("&","AND").replace("$","DOL").replace("Â£","STERL").replace("@","AT").replace(/\s/g,"_");o=o.replace(/[^a-zA-Z 0-9]+/g,"");p=s;(e.sFilterButtonText!=null||e.sFilterButtonText!=undefined)&&(p=e.sFilterButtonText);var b=12,l=Math.floor(y/b);y%b>0&&(l=l+1);k=100/l-2;rt=10*l;l==1&&(k=20);var ut='<div style="float:left; min-width: '+k+'%; " >',d=t.attr("id")+o,v="chkBtnOpen"+d,a=d+"-flt-toggle";for(h+='<button id="'+v+'" class="checkbox_filter btn btn-default" > '+p+"<\/button>",h+='<div id="'+a+'" title="'+s+'" rel="'+r+'" class="toggle-check ui-widget-content ui-corner-all"  style="width: '+rt+'%; " >',h+=ut,g=t.fnSettings().aoPreSearchCols[r].sSearch,ft=g?g.split("|"):[],u=0;u<y;u++){u%b==0&&u!=0&&(h+="<\/div>"+ut);var st=n.inArray(i[u],ft)>-1,et=i[u],nt=i[u];typeof i[u]=="object"&&(et=i[u].label,nt=i[u].value);h+='<input class="search_init checkbox_filter btn btn-default" type="checkbox" id= "'+d+"_cb_"+nt+'" name= "'+o+'" '+(st?' checked = "checked"':"")+' value="'+nt+'" >'+et+"<br/>";tt=n(h);f.html(tt);f.wrapInner('<span class="filter_column filter_checkbox" />');tt.change(function(){var i="",r="|",u=n('input:checkbox[name="'+o+'"]:checked').size();n('input:checkbox[name="'+o+'"]:checked').each(function(t){(t==0&&u==1||t!=0&&t==u-1)&&(r="");i=i.replace(/^\s+|\s+$/g,"");i=i+n(this).val()+r;r="|"});i!=""?n('input:checkbox[name="'+o+'"]').removeClass("search_init"):n('input:checkbox[name="'+o+'"]').addClass("search_init");t.fnFilter(i,it,!0,!1);c()})}n("#"+v).button();n("#"+a).dialog({autoOpen:!1,hide:"blind",buttons:[{text:"Reset",click:function(){return n('input:checkbox[name="'+o+'"]:checked').each(function(){n(this).attr("checked",!1);n(this).addClass("search_init")}),t.fnFilter("",it,!0,!1),c(),!1}},{text:"Close",click:function(){n(this).dialog("close")}}]});n("#"+v).click(function(){n("#"+a).dialog("open");var t=n(this);return n("#"+a).dialog("widget").position({my:"top",at:"bottom",of:t}),!1});ot=c;c=function(){var t=n("#"+v);n("#"+a).dialog("widget").position({my:"top",at:"bottom",of:t});ot()}}function y(n){switch(n){case 0:return h.substring(0,h.indexOf("{from}"));case 1:return h.substring(h.indexOf("{from}")+6,h.indexOf("{to}"));default:return h.substring(h.indexOf("{to}")+4)}}var o=n.merge({},i.columnBuilders||{}),v,r,s,f,h="From {from} to {to}",p=[],a=[],c=function(){};o.number=function(n,t){b(n,!0,!1,!0,t.iFilterLength,t.iMaxLenght)};o.select=function(n,t){t.bRegex!=!0&&(t.bRegex=!1);it(n,t.values,t.bRegex,t.selected,t.multiple)};o["number-range"]=function(n){tt(n)};o["date-range"]=function(n){d(n,"datepicker")};o["datetime-range"]=function(n){d(n,"datetimepicker")};o.checkbox=function(n,t){ut(n,t.values)};o["twitter-dropdown"]=function(n,t){nt(t.values)};o.dropdown=function(n,t){nt(t.values)};o["default"]=function(n,t){bRegex=t.bRegex==null?!1:t.bRegex;bSmart=t.bSmart==null?!1:t.bSmart;b(n,bRegex,bSmart,!1,t.iFilterLength,t.iMaxLenght)};var u=this,e=n.extend({sPlaceHolder:"foot",sRangeSeparator:"~",iFilteringDelay:500,aoColumns:null,sRangeFormat:"From {from} to {to}",sDateFromToken:"from",sDateToToken:"to"},i);return this.each(function(){var i,w,c;if(u.fnSettings().oFeatures.bFilter){v=[];var t=u.fnSettings().aoFooter[0],l=u.fnSettings().nTFoot,y="tr";for(e.sPlaceHolder=="head:after"?(i=n("tr:first",u.fnSettings().nTHead).detach(),u.fnSettings().bSortCellsTop?(i.prependTo(n(u.fnSettings().nTHead)),t=u.fnSettings().aoHeader[1]):(i.appendTo(n(u.fnSettings().nTHead)),t=u.fnSettings().aoHeader[0]),y="tr:last",l=u.fnSettings().nTHead):e.sPlaceHolder=="head:before"&&(u.fnSettings().bSortCellsTop?(i=n("tr:first",u.fnSettings().nTHead).detach(),i.appendTo(n(u.fnSettings().nTHead)),t=u.fnSettings().aoHeader[1]):t=u.fnSettings().aoHeader[0],y="tr:first",l=u.fnSettings().nTHead),n(t).each(function(t){var i,c;if(r=t,i={type:"text",bRegex:!1,bSmart:!0,iMaxLenght:-1,iFilterLength:0},e.aoColumns!=null){if(e.aoColumns.length<r||e.aoColumns[r]==null)return;i=e.aoColumns[r]}s=n(n(this)[0].cell).text();i.sSelector==null?f=n(n(this)[0].cell):(f=n(i.sSelector),f.length==0&&(f=n(n(this)[0].cell)));i!=null&&(h=i.sRangeFormat!=null?i.sRangeFormat:e.sRangeFormat,c=o[i.type]||o["default"],c(u,i))}),j=0;j<a.length;j++)w=function(){var t=u.attr("id");return n("#"+t+"_range_from_"+a[j]).val()+e.sRangeSeparator+n("#"+t+"_range_to_"+a[j]).val()},p.push(w);u.fnSettings().oFeatures.bServerSide&&(c=u.fnSettings().fnServerData,u.fnSettings().fnServerData=function(t,i,r){for(j=0;j<a.length;j++){var f=a[j];for(k=0;k<i.length;k++)i[k].name=="sSearch_"+f&&(i[k].value=p[j](),u.fnSettings().aoPreSearchCols[f].sSearch=i[k].value)}if(i.push({name:"sRangeSeparator",value:e.sRangeSeparator}),c!=null)try{c(t,i,r,u.fnSettings())}catch(o){c(t,i,r)}else n.getJSON(t,i,function(n){r(n)})})}})}})(jQuery);